<canvas id="ctx" width="1000" height="500" style="border:1px solid #000000"></canvas>
<script src="/socket.io/socket.io.js"></script>
<script>
    var ctx = document.getElementById("ctx").getContext("2d");
    ctx.font = '30px Arial';
    var socket = io();

    socket.on('update', function(data){
        ctx.clearRect(0,0,1000,500);
        ctx.beginPath();
        for(var i=0; i<data.length; i++){
            ctx.fillRect(data[i].x, data[i].y, data[i].size, data[i].size);
            let rgbText = "rgb(" + data[i].r+ "," + data[i].g + "," + data[i].b + ")";
            ctx.fillStyle = rgbText;
        }
        ctx.stroke();
    });

    var push = function(dirValue){
        socket.emit('ctrl', {dir:dirValue, state:true});
    }

    var pull = function(dirValue){
        socket.emit('ctrl', {dir:dirValue, state:false});
    }

    document.onkeydown = function(event){
        if(event.keyCode === 68){
            socket.emit('keyPress', {dir:"right", state:true});
        }
        else if(event.keyCode === 83){
            socket.emit('keyPress', {dir:"down", state:true});
        }
        else if(event.keyCode === 65){
            socket.emit('keyPress', {dir:"left", state:true});
        }
        else if(event.keyCode === 87){
            socket.emit('keyPress', {dir:"up", state:true});
        }

        if(event.keyCode === 39){
            socket.emit('shoot', {dir:"right"});
        }
        else if(event.keyCode === 40){
            socket.emit('shoot', {dir:"down"});
        }
        else if(event.keyCode === 37){
            socket.emit('shoot', {dir:"left"});
        }
        else if(event.keyCode === 38){
            socket.emit('shoot', {dir:"up"});
        }

    }

    document.onkeyup = function(event){
        if(event.keyCode === 68){
            socket.emit('keyPull', {dir:"right", state:false});
        }
        else if(event.keyCode === 83){
            socket.emit('keyPull', {dir:"down", state:false});
        }
        else if(event.keyCode === 65){
            socket.emit('keyPull', {dir:"left", state:false});
        }
        else if(event.keyCode === 87){
            socket.emit('keyPull', {dir:"up", state:false});
        }

    }

</script>

<button onclick="push('up')" onkeydown="pull('up')">Up</button>
<button onclick="push('down')" onkeydown="pull('down')">Down</button>
<button onclick="push('left')" onkeydown="pull('left')">Left</button>
<button onclick="push('right')" onkeydown="pull('right')">Right</button>